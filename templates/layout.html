<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Get&nbsp;the&nbsp;Bear | Portfolio Analysis Tool</title>

    <!-- Google fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">

    <!-- Plotly (only used in a few legacy chart blocks) -->
    <script src="https://cdn.plot.ly/plotly-2.12.1.min.js"></script>

    <!-- Chart.js - Using /auto bundle for common components -->
    <!-- Note: This bundle includes common controllers, elements, scales, and plugins -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.auto.min.js"></script>

    <!-- Luxon date‑adapter for the time scale -->
    <script src="https://cdn.jsdelivr.net/npm/luxon@3"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-luxon@1"></script>

    <!-- Custom matrix controller implementation -->
    <!-- Needs to be loaded AFTER Chart.js -->
    <script src="{{ url_for('static', filename='js/custom-matrix.js') }}"></script>

    <!-- Fuse.js (ticker search) -->
    <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>

    <!-- Custom stylesheet -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">

    <!-- Remove old helpers, registration will be simplified -->
    <!-- <script src="{{ url_for('static', filename='js/chartPlugins.js') }}"></script> -->
    <!-- <script src="{{ url_for('static', filename='js/charts.js') }}" type="module"></script> -->
</head>
<body>
    <header>
        <div class="container header-content">
            <div class="logo">Get the Bear</div>
            <div class="app-description">
                Portfolio analysis tool for visualising investment performance across multiple securities
            </div>
        </div>
    </header>

    <main>
        <div class="container">
            {% block content %}{% endblock %}
        </div>
    </main>

    <footer>
        <div class="container footer-content">
            <p>Get the Bear – Investment Portfolio Analysis Tool © 2023</p>
        </div>
    </footer>

    <!-- ------------------------------------------------------------------
         JAVASCRIPT
         ------------------------------------------------------------------
         - Main logic is now type="module"
         1.  chart shim  (ES‑module – re‑exports modules under /static/js/modules)
         2.  main page logic (classic script – no imports)
         ------------------------------------------------------------------ -->

    <!-- Main UI / AJAX logic (as ES Module) -->
    <script src="{{ url_for('static', filename='js/main.js') }}" type="module"></script>

    <!-- Optional: tiny in‑browser console (add ?debug=true to the URL) -->
    <script defer>
        (() => {
            if (new URLSearchParams(location.search).get('debug') === 'true') {
                const s = document.createElement('script');
                s.src = 'https://cdn.jsdelivr.net/npm/eruda';
                s.onload = () => eruda.init();
                document.body.appendChild(s);
            }
        })();
    </script>
</body>
</html>
